<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>TRAINING - Interfacing with the Vector Network Analyzer — 6.2410 -- Laboratory for Quantum Information Science and Engineering</title>
<link href="../_static/css/theme.css" rel="stylesheet"/>
<link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet"/>
<link href="../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" rel="stylesheet" type="text/css"/>
<link href="../_static/togglebutton.css" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="../_static/mystnb.css" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<link as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js" rel="preload"/>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
<script src="../_static/jquery.js"></script>
<script src="../_static/underscore.js"></script>
<script src="../_static/doctools.js"></script>
<script src="../_static/clipboard.min.js"></script>
<script src="../_static/copybutton.js"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../_static/togglebutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../_static/sphinx-thebe.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
<script>window.MathJax = {"tex": {"macros": {"ket": ["\\left|{#1}\\right\\rangle", 1], "bra": ["\\left\\langle{#1}\\right|", 1], "braket": ["\\left\\langle{#1}\\middle|{#2}\\right\\rangle", 2], "adagger": ["\\hat{a}^{\\dagger}"], "ahat": ["\\hat{a}"], "bdagger": ["\\hat{b}^{\\dagger}"], "bhat": ["\\hat{b}"], "cdagger": ["\\hat{c}^{\\dagger}"], "chat": ["\\hat{c}"], "ddagger": ["\\hat{d}^{\\dagger}"], "dhat": ["\\hat{d}"], "edagger": ["\\hat{e}^{\\dagger}"], "ehat": ["\\hat{e}"], "fdagger": ["\\hat{f}^{\\dagger}"], "fhat": ["\\hat{f}"], "gdagger": ["\\hat{g}^{\\dagger}"], "ghat": ["\\hat{g}"], "hdagger": ["\\hat{h}^{\\dagger}"], "hhat": ["\\hat{h}"], "gtwo": ["g^{(2)}"], "H": ["\\ket{H}"], "V": ["\\ket{V}"], "D": ["\\ket{D}"], "AD": ["\\ket{AD}"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="T3E3-TEXT-Quantum-Sensing-with-Solid-State-Spins.html" rel="next" title="TEXT: Introduction to NV centers in diamond and cavity-based magnetometry"/>
<link href="../T2E1-LAB-BB84.html" rel="prev" title="LAB – QKD (Week 2)"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
<link href="../_static/css/chattutor.css" rel="stylesheet" type="text/css"/></head>
<body data-offset="80" data-spy="scroll" data-target="#bd-toc-nav">
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
<div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../_static/logo-ibm.jpg"/>
<h1 class="site-logo" id="site-title">6.2410 -- Laboratory for Quantum Information Science and Engineering</h1>
</a>
</div><form action="../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../intro.html">
   6.2410 – Laboratory in Quantum Systems Engineering: Quantum Engineering Platforms
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Introductory Material
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../BASICS-quantum-optics-basics.html">
   BASICS – Quantum Optics
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  T3E1 -- Interference, Entanglement, Quantum-Enhanced Sensing
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../T3E1-TEXT--entanglement-interference-quantum-enhanced-sensing.html">
   TEXT – Interference, Entanglement and Quantum-Enhanced Metrology
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../T3E1-LAB--entanglement-interference-quantum-enhanced-sensing.html">
   LAB – Interference, Entanglement and Quantum-Enhanced Metrology
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../T3E1-EXTRAS--rigorous-solution-MZI.html">
   EXTRAS – Rigorous Solution of Mach-Zender Interferometer
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../T3E1-EXTRAS-interference-2-homodyne-detection.html">
   EXTRAS – Homodyne Detection
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  T2E1 -- Quantum Information and Quantum Key Distribution
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../T2E1-TEXT-HBT.html">
   TEXT - Introduction to single photons with the quED (Week 1)
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../T2E1-LAB-HBT.html">
   LAB – Hanbury Brown - Twiss Lab (Week 1)
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../T2E1-TEXT-QKD.html">
   TEXT – QKD (Week 2)
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../T2E1-LAB-BB84.html">
   LAB – QKD (Week 2)
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  T3E3 -- Solid State Spins
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active">
<a class="current reference internal" href="#">
   TRAINING - Interfacing with the Vector Network Analyzer
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="T3E3-TEXT-Quantum-Sensing-with-Solid-State-Spins.html">
   TEXT: Introduction to NV centers in diamond and cavity-based magnetometry
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="T3E3-LAB-Week1-Quantum-Sensing-with-Solid-State-Spins.html">
   LAB - Quantum Sensing with Solid State Spins (Week 1)
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="T3E3-LAB-Week2-Quantum-Sensing-with-Solid-State-Spins.html">
   LAB – Quantum Sensing With Solid State Spins (Week 2)
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  T1E2 -- Quantum Computing w/ IBM Qiskit (OPTIONAL)
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../T1E2-LAB-IBM-Qiskit-Prelab.html">
   PRELAB –Intro to IBM Qiskit
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../T1E2-LAB-IBM-Qiskit.html">
   LAB – Quantum Computing w/ Qiskit
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../T1E2-LAB-IBM-Qiskit-Solutions.html">
   SOLUTIONS – Quantum Computing with Qiskit
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Final Projects
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../FINAL-PROJECTS.html">
   Final Design Project
  </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading">
<span class="caption-text">
  Other Resources
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../OTHER-quantum-monte-carlo-simulation-spin-entanglement-repeaters.html">
   Entanglement Distribution by Quantum Repeaters: Exploration by Quantum Monte Carlo Simulation
  </a>
</li>
</ul>
</div>
</nav> <!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
<div class="topbar container-xl fixed-top">
<div class="topbar-contents row">
<div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
<div class="col pl-md-4 topbar-main">
<button aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" class="navbar-toggler ml-0" data-placement="bottom" data-target=".site-navigation" data-toggle="collapse" id="navbar-toggler" title="Toggle navigation" type="button">
<i class="fas fa-bars"></i>
<i class="fas fa-arrow-left"></i>
<i class="fas fa-arrow-up"></i>
</button>
<div class="dropdown-buttons-trigger">
<button aria-label="Download this page" class="btn btn-secondary topbarbtn" id="dropdown-buttons-trigger"><i class="fas fa-download"></i></button>
<div class="dropdown-buttons">
<!-- ipynb file if we had a myst markdown file -->
<!-- Download raw file -->
<a class="dropdown-buttons" href="../_sources/quNV-Jupyter/T3E3-PARKOUR-Quantum-Sensing-with-Solid-State-Spins.ipynb"><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Download source file" type="button">.ipynb</button></a>
<!-- Download PDF via print -->
<button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" id="download-print" onclick="printPdf(this)" title="Print to PDF" type="button">.pdf</button>
</div>
</div>
<!-- Source interaction buttons -->
<div class="dropdown-buttons-trigger">
<button aria-label="Connect with source repository" class="btn btn-secondary topbarbtn" id="dropdown-buttons-trigger"><i class="fab fa-github"></i></button>
<div class="dropdown-buttons sourcebuttons">
<a class="repository-button" href="https://github.com/dkeathley/S23-6.2410-lab"><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Source repository" type="button"><i class="fab fa-github"></i>repository</button></a>
<a class="issues-button" href="https://github.com/dkeathley/S23-6.2410-lab/issues/new?title=Issue%20on%20page%20%2FquNV-Jupyter/T3E3-PARKOUR-Quantum-Sensing-with-Solid-State-Spins.html&amp;body=Your%20issue%20content%20here."><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Open an issue" type="button"><i class="fas fa-lightbulb"></i>open issue</button></a>
</div>
</div>
<!-- Full screen (wrap in <a> to have style consistency -->
<a class="full-screen-button"><button aria-label="Fullscreen mode" class="btn btn-secondary topbarbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode" type="button"><i class="fas fa-expand"></i></button></a>
<!-- Launch buttons -->
<div class="dropdown-buttons-trigger">
<button aria-label="Launch interactive content" class="btn btn-secondary topbarbtn" id="dropdown-buttons-trigger"><i class="fas fa-rocket"></i></button>
<div class="dropdown-buttons">
<a class="binder-button" href="https://mybinder.org/v2/gh/dkeathley/S23-6.2410-lab/main?urlpath=tree/quNV-Jupyter/T3E3-PARKOUR-Quantum-Sensing-with-Solid-State-Spins.ipynb"><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Launch Binder" type="button"><img alt="Interact on binder" class="binder-button-logo" src="../_static/images/logo_binder.svg"/>Binder</button></a>
<a class="colab-button" href="https://colab.research.google.com/github/dkeathley/S23-6.2410-lab/blob/main/quNV-Jupyter/T3E3-PARKOUR-Quantum-Sensing-with-Solid-State-Spins.ipynb"><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Launch Colab" type="button"><img alt="Interact on Colab" class="colab-button-logo" src="../_static/images/logo_colab.png"/>Colab</button></a>
</div>
</div>
</div>
<!-- Table of contents -->
<div class="d-none d-md-block col-md-2 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
            </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#installing-the-vna-gui">
   1. Installing the VNA GUI
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#familiarize-with-the-gui">
   2. Familiarize with the GUI
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#establish-connection-with-the-vna-via-python">
   3. Establish connection with the VNA via Python
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-the-python-file-below-make-sure-it-is-either-in-the-same-directory-as-this-jupyter-notebook-or-modify-the-directory-path-when-importing">
     3.1 Download the Python file below. Make sure it is either in the same directory as this Jupyter notebook or modify the directory path when importing.
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#next-try-running-the-next-code-block">
     3.2 Next, try running the next code block.
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#connecting-to-the-vna">
     3.3 Connecting to the VNA
    </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#setting-the-vna-parameters">
   4. Setting the VNA parameters
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#grabbing-data-off-the-vna">
   5. Grabbing data off the VNA
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="row" id="main-content">
<div class="col-12 col-md-9 pl-md-3 pr-md-0">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>TRAINING - Interfacing with the Vector Network Analyzer</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#installing-the-vna-gui">
   1. Installing the VNA GUI
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#familiarize-with-the-gui">
   2. Familiarize with the GUI
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#establish-connection-with-the-vna-via-python">
   3. Establish connection with the VNA via Python
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#download-the-python-file-below-make-sure-it-is-either-in-the-same-directory-as-this-jupyter-notebook-or-modify-the-directory-path-when-importing">
     3.1 Download the Python file below. Make sure it is either in the same directory as this Jupyter notebook or modify the directory path when importing.
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#next-try-running-the-next-code-block">
     3.2 Next, try running the next code block.
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#connecting-to-the-vna">
     3.3 Connecting to the VNA
    </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#setting-the-vna-parameters">
   4. Setting the VNA parameters
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#grabbing-data-off-the-vna">
   5. Grabbing data off the VNA
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div>
<div class="section" id="training-interfacing-with-the-vector-network-analyzer">
<h1>TRAINING - Interfacing with the Vector Network Analyzer<a class="headerlink" href="#training-interfacing-with-the-vector-network-analyzer" title="Permalink to this headline">¶</a></h1>
<p>In this exercise, we will practice using Python to communicate with the vector network analyzer (VNA), which allows us to probe the microwave cavity’s frequency response. In short, the VNA acts as both a signal generator and a receiver. Within a defined frequency sweep, <span class="math notranslate nohighlight">\(\omega\in[\omega_1,\omega_2]\)</span>, it sends a signal at frequency <span class="math notranslate nohighlight">\(\omega\)</span> and measures the reflected power off the cavity. When <span class="math notranslate nohighlight">\(\omega\)</span> is resonant with the cavity’s resonance frequency <span class="math notranslate nohighlight">\(\omega_c\)</span>, i.e. <span class="math notranslate nohighlight">\(\omega=\omega_c\)</span>, the reflected power would be minimal. This will be covered in more details in the textbook. For now, we will focus on writing a small piece of code to send commands to the VNA, and collecting the relevant measurement data, <span class="math notranslate nohighlight">\(S_{21}\)</span>.</p>
<div class="section" id="installing-the-vna-gui">
<h2>1. Installing the VNA GUI<a class="headerlink" href="#installing-the-vna-gui" title="Permalink to this headline">¶</a></h2>
<p>The GUI software for the VNA can be downloaded here: <a class="reference external" href="https://github.com/jankae/LibreVNA/releases">https://github.com/jankae/LibreVNA/releases</a></p>
<p>You may download either the latest version or pre-release.</p>
<p>You may also designate one person whose laptop/computer will be installed with the software. However, each person still needs to submit their own code.</p>
</div>
<div class="section" id="familiarize-with-the-gui">
<h2>2. Familiarize with the GUI<a class="headerlink" href="#familiarize-with-the-gui" title="Permalink to this headline">¶</a></h2>
<p>Make sure the VNA is USB-connected to your computer. Then, open the LibreVNA-GUI. In the “Device” tab, you should be able to see the VNA’s device ID in “Connect To”. Select the device, and you should be seeing four quadrants, each representing a <a class="reference external" href="https://en.wikipedia.org/wiki/Scattering_parameters">S-parameter</a>. For the experiment you will be running, only <span class="math notranslate nohighlight">\(S_{21}\)</span> is needed. You may enlarge the “S21” screen by dragging its boundaries.</p>
<p>In the top bar, make sure the “Sweep type” is Frequency. You can define the frequency sweep range by either setting (1) Start and Stop, or (2) Center and Span.</p>
<p>Right-clicking on the plot and selecting “Axis Setup” allows you to select “Auto” for the axes’ range. This is important if you want to monitor signals with changing amplitudes and/or after you change the frequency sweep range.</p>
<p><em>Note that Ports 1 &amp; 2 of the VNA are not connected to anything at the moment, so you should just be seeing noise in the “S21” plot.</em></p>
</div>
<div class="section" id="establish-connection-with-the-vna-via-python">
<h2>3. Establish connection with the VNA via Python<a class="headerlink" href="#establish-connection-with-the-vna-via-python" title="Permalink to this headline">¶</a></h2>
<div class="section" id="download-the-python-file-below-make-sure-it-is-either-in-the-same-directory-as-this-jupyter-notebook-or-modify-the-directory-path-when-importing">
<h3>3.1 Download the Python file below. Make sure it is either in the same directory as this Jupyter notebook or modify the directory path when importing.<a class="headerlink" href="#download-the-python-file-below-make-sure-it-is-either-in-the-same-directory-as-this-jupyter-notebook-or-modify-the-directory-path-when-importing" title="Permalink to this headline">¶</a></h3>
<p>Click <a class="reference external" href="https://drive.google.com/file/d/1kkkXeQyyrg6BMhK2RJBleBGn8OjrYlfB/view?usp=sharing">here</a> to download.</p>
</div>
<div class="section" id="next-try-running-the-next-code-block">
<h3>3.2 Next, try running the next code block.<a class="headerlink" href="#next-try-running-the-next-code-block" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN ME</span>
<span class="kn">from</span> <span class="nn">libreVNA</span> <span class="kn">import</span> <span class="n">libreVNA</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="connecting-to-the-vna">
<h3>3.3 Connecting to the VNA<a class="headerlink" href="#connecting-to-the-vna" title="Permalink to this headline">¶</a></h3>
<p>If the above block runs without an issue, run the next code block to establish connection. After creating a handle to the VNA, you will notice there are two methods to communicate with the device.<code class="docutils literal notranslate"><span class="pre">vna.query(XXX)</span></code> and <code class="docutils literal notranslate"><span class="pre">vna.command(XXX)</span></code>. The former sends a command to the VNA and asks for a response (aka query), and the latter only sends a command. The input <code class="docutils literal notranslate"><span class="pre">XXX</span></code> to either of these methods is a <a class="reference external" href="https://en.wikipedia.org/wiki/Standard_Commands_for_Programmable_Instruments">SCPI</a> (Standard Commands for Programmable Instruments). For a complete of list of SCPI commands for the VNA, consult the Programming Guide below:</p>
<p>Click <a class="reference external" href="https://drive.google.com/file/d/1GpGNjROYpluPD1voHh7sdNY6kIebRYhF/view?usp=share_link">here</a> to download.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RUN ME</span>

<span class="c1"># Establish VNA connection</span>
<span class="c1"># note: remember to communicate with the VNA, the GUI must be running</span>

<span class="c1"># Create the control instance</span>
<span class="n">vna</span> <span class="o">=</span> <span class="n">libreVNA</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">19542</span><span class="p">)</span>

<span class="c1"># Quick connection check (should print "LibreVNA-GUI")</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vna</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"*IDN?"</span><span class="p">))</span>

<span class="c1"># Make sure we are connecting to a device (just to be sure, with default settings the LibreVNA-GUI auto-connects)</span>
<span class="n">vna</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">":DEV:CONN"</span><span class="p">)</span>
<span class="n">dev</span> <span class="o">=</span> <span class="n">vna</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">":DEV:CONN?"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">dev</span> <span class="o">==</span> <span class="s2">"Not connected"</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Not connected to any device, aborting"</span><span class="p">)</span>
    <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Connected to "</span><span class="o">+</span><span class="n">dev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ConnectionRefusedError</span><span class="g g-Whitespace">                    </span>Traceback (most recent call last)
<span class="nn">File ~/Desktop/S23-6.2410-lab/quNV-Jupyter/libreVNA.py:72,</span> in <span class="ni">libreVNA.__init__</span><span class="nt">(self, host, port)</span>
<span class="g g-Whitespace">     </span><span class="mi">71</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">72</span>     <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">except</span><span class="p">:</span>

<span class="ne">ConnectionRefusedError</span>: [Errno 61] Connection refused

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">Exception</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># RUN ME</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># Establish VNA connection</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># note: remember to communicate with the VNA, the GUI must be running</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1"># Create the control instance</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">vna</span> <span class="o">=</span> <span class="n">libreVNA</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="mi">19542</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1"># Quick connection check (should print "LibreVNA-GUI")</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="nb">print</span><span class="p">(</span><span class="n">vna</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"*IDN?"</span><span class="p">))</span>

<span class="nn">File ~/Desktop/S23-6.2410-lab/quNV-Jupyter/libreVNA.py:74,</span> in <span class="ni">libreVNA.__init__</span><span class="nt">(self, host, port)</span>
<span class="g g-Whitespace">     </span><span class="mi">72</span>     <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">73</span> <span class="k">except</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">74</span>     <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"Unable to connect to LibreVNA-GUI. Make sure it is running and the TCP server is enabled."</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">SocketStreamReader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="p">)</span>

<span class="ne">Exception</span>: Unable to connect to LibreVNA-GUI. Make sure it is running and the TCP server is enabled.
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="setting-the-vna-parameters">
<h2>4. Setting the VNA parameters<a class="headerlink" href="#setting-the-vna-parameters" title="Permalink to this headline">¶</a></h2>
<p>Write a Python script that does the following:</p>
<ol class="simple">
<li><p>Sets the frequency sweep range from 2.93 GHz to 2.95 GHz</p></li>
<li><p>Sets the sweep with 51 frequency points</p></li>
<li><p>Sets the <a class="reference external" href="https://en.wikipedia.org/wiki/Intermediate_frequency">intermediate frequency</a> bandwidth to 1 kHz</p></li>
<li><p>Sets the number of average to 1</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code goes here</span>

<span class="c1"># 1</span>
<span class="n">vna</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">":VNA:FREQuency:CENTer 2940000000"</span><span class="p">)</span>
<span class="n">vna</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">":VNA:FREQuency:SPAN 20000000"</span><span class="p">)</span>

<span class="c1"># 2</span>
<span class="n">vna</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">":VNA:ACQ:POINTS 51"</span><span class="p">)</span>

<span class="c1"># 3</span>
<span class="n">vna</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">":VNA:ACQ:IFBW 1000"</span><span class="p">)</span>

<span class="c1"># 4</span>
<span class="n">vna</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="s2">":VNA:ACQ:AVG 1"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="grabbing-data-off-the-vna">
<h2>5. Grabbing data off the VNA<a class="headerlink" href="#grabbing-data-off-the-vna" title="Permalink to this headline">¶</a></h2>
<p>Write a Python script that extracts <span class="math notranslate nohighlight">\(S_{21}\)</span> data vector, and plots both the amplitude and phase entries. You may find the method <code class="docutils literal notranslate"><span class="pre">vna.parse_VNA_trace_data(...)</span></code> helpful.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code goes here</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># grab the data of trace S21</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">vna</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">":VNA:TRACE:DATA? S21"</span><span class="p">)</span>

<span class="n">S21</span> <span class="o">=</span> <span class="n">vna</span><span class="o">.</span><span class="n">parse_VNA_trace_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">S21</span><span class="p">[:][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S21</span><span class="p">[:][</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">S21</span><span class="p">[:][</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Plot amplitude and phase</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span><span class="n">amp</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Frequency'</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Amplitude (a.u.)'</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span><span class="n">phase</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Phase (deg)'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./quNV-Jupyter"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="../T2E1-LAB-BB84.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">LAB – QKD (Week 2)</p>
</div>
</a>
<a class="right-next" href="T3E3-TEXT-Quantum-Sensing-with-Solid-State-Spins.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">TEXT: Introduction to NV centers in diamond and cavity-based magnetometry</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</div>
<html><body><div>
<div class="msger-expand">
<div class="msger-header-title">
<i class="fas fa-comment-alt"></i> ChatTutor
    </div>
<div class="msger-header-options">
<span><i class="fas fa-solid fa-caret-up"></i></span>
</div>
</div>
<div class="msger minimized">
<header class="msger-header">
<div class="msger-header-title">
<i class="fas fa-comment-alt"></i> ChatTutor
        </div>
<div class="msger-header-options">
<span><i class="fas fa-solid fa-window-minimize msger-minimize"></i></span>
</div>
</header>
<main class="msger-chat">
<div class="msg left-msg">
<div class="msg-img" style="background-image: url(https://static.thenounproject.com/png/2216285-200.png)"></div>
<div class="msg-bubble">
<div class="msg-info">
<div class="msg-info-name">ChatTutor</div>
</div>
<div class="msg-text">
            Welcome to ChatTutor, feel free to ask any questions about this lesson.
        </div>
</div>
</div>
<div class="clear-btn-container">
<button class="clear-btn">
          Clear conversation
        </button>
</div>
</main>
<form class="msger-inputarea">
<input class="msger-input" placeholder="Enter your message..." type="text"/>
<button class="msger-send-btn" type="submit">Send</button>
</form>
</div>
</div></body></html></div>
<footer class="footer">
<p>
    
      By Dirk Englund, Donnie Keathley, Jane Heyes, Kevin Chen<br/>
    
        © Copyright 2021.<br/>
</p>
</footer>
</main>
</div>
</div>
<script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<script src="../_static/js/chattutor.js"></script></body>
</html>