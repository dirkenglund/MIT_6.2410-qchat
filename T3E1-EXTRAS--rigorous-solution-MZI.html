
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EXTRAS – Rigorous Solution of Mach-Zender Interferometer &#8212; 6.2410 -- Laboratory for Quantum Information Science and Engineering</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ket": ["\\left|{#1}\\right\\rangle", 1], "bra": ["\\left\\langle{#1}\\right|", 1], "braket": ["\\left\\langle{#1}\\middle|{#2}\\right\\rangle", 2], "adagger": ["\\hat{a}^{\\dagger}"], "ahat": ["\\hat{a}"], "bdagger": ["\\hat{b}^{\\dagger}"], "bhat": ["\\hat{b}"], "cdagger": ["\\hat{c}^{\\dagger}"], "chat": ["\\hat{c}"], "ddagger": ["\\hat{d}^{\\dagger}"], "dhat": ["\\hat{d}"], "edagger": ["\\hat{e}^{\\dagger}"], "ehat": ["\\hat{e}"], "fdagger": ["\\hat{f}^{\\dagger}"], "fhat": ["\\hat{f}"], "gdagger": ["\\hat{g}^{\\dagger}"], "ghat": ["\\hat{g}"], "hdagger": ["\\hat{h}^{\\dagger}"], "hhat": ["\\hat{h}"], "gtwo": ["g^{(2)}"], "H": ["\\ket{H}"], "V": ["\\ket{V}"], "D": ["\\ket{D}"], "AD": ["\\ket{AD}"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="EXTRAS – Homodyne Detection" href="T3E1-EXTRAS-interference-2-homodyne-detection.html" />
    <link rel="prev" title="LAB – Interference, Entanglement and Quantum-Enhanced Metrology" href="T3E1-LAB--entanglement-interference-quantum-enhanced-sensing.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo-ibm.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">6.2410 -- Laboratory for Quantum Information Science and Engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   6.2410 – Laboratory in Quantum Systems Engineering: Quantum Engineering Platforms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introductory Material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="BASICS-quantum-optics-basics.html">
   BASICS – Quantum Optics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  T3E1 -- Interference, Entanglement, Quantum-Enhanced Sensing
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="T3E1-TEXT--entanglement-interference-quantum-enhanced-sensing.html">
   TEXT – Interference, Entanglement and Quantum-Enhanced Metrology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T3E1-LAB--entanglement-interference-quantum-enhanced-sensing.html">
   LAB – Interference, Entanglement and Quantum-Enhanced Metrology
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   EXTRAS – Rigorous Solution of Mach-Zender Interferometer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T3E1-EXTRAS-interference-2-homodyne-detection.html">
   EXTRAS – Homodyne Detection
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  T2E1 -- Quantum Information and Quantum Key Distribution
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="T2E1-TEXT-HBT.html">
   TEXT - Introduction to single photons with the quED (Week 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T2E1-LAB-HBT.html">
   LAB – Hanbury Brown - Twiss Lab (Week 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T2E1-TEXT-QKD.html">
   TEXT – QKD (Week 2)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="T2E1-LAB-BB84.html">
   LAB – QKD (Week 2)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  T3E3 -- Solid State Spins
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="quNV-Jupyter/T3E3-PARKOUR-Quantum-Sensing-with-Solid-State-Spins.html">
   TRAINING - Interfacing with the Vector Network Analyzer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quNV-Jupyter/T3E3-TEXT-Quantum-Sensing-with-Solid-State-Spins.html">
   TEXT: Introduction to NV centers in diamond and cavity-based magnetometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quNV-Jupyter/T3E3-LAB-Week1-Quantum-Sensing-with-Solid-State-Spins.html">
   LAB - Quantum Sensing with Solid State Spins (Week 1)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quNV-Jupyter/T3E3-LAB-Week2-Quantum-Sensing-with-Solid-State-Spins.html">
   LAB – Quantum Sensing With Solid State Spins (Week 2)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/T3E1-EXTRAS--rigorous-solution-MZI.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/dkeathley/S23-6.2410-lab"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/dkeathley/S23-6.2410-lab/issues/new?title=Issue%20on%20page%20%2FT3E1-EXTRAS--rigorous-solution-MZI.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/dkeathley/S23-6.2410-lab/main?urlpath=tree/T3E1-EXTRAS--rigorous-solution-MZI.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/dkeathley/S23-6.2410-lab/blob/main/T3E1-EXTRAS--rigorous-solution-MZI.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#complete-solution-without-an-object">
   Complete solution without an object
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accounting-for-the-partial-absorber">
   Accounting for the partial absorber
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accounting-for-bandwidth">
   Accounting for Bandwidth
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>EXTRAS – Rigorous Solution of Mach-Zender Interferometer</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#complete-solution-without-an-object">
   Complete solution without an object
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accounting-for-the-partial-absorber">
   Accounting for the partial absorber
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accounting-for-bandwidth">
   Accounting for Bandwidth
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="extras-rigorous-solution-of-mach-zender-interferometer">
<h1>EXTRAS – Rigorous Solution of Mach-Zender Interferometer<a class="headerlink" href="#extras-rigorous-solution-of-mach-zender-interferometer" title="Permalink to this headline">¶</a></h1>
<p>In the course material for the discussion of single-photon interference and the interaction-free measurement, we took a shortcut to calculating the photon number expectation by ignoring the operators of the vacuum state inputs.  This simplifies the problem, but is not a rigorous solution.  A particular shortcoming is that this approach would give incorrect results for calculating the noise properties of the photon number at the detectors as in that case the vacuum state input does matter.</p>
<div class="section" id="complete-solution-without-an-object">
<h2>Complete solution without an object<a class="headerlink" href="#complete-solution-without-an-object" title="Permalink to this headline">¶</a></h2>
<p>The problem setup is the same, however now we must include all inputs, which slightly modifies our setup as shown in <a class="reference internal" href="#fig-t3e1-single-photon-interferometer-complete"><span class="std std-numref">Fig. 28</span></a>.</p>
<div class="figure align-default" id="fig-t3e1-single-photon-interferometer-complete">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/T3E1-single-photon-interferometer-complete.png"><img alt="Single Photon Interference" class="bg-primary mb-1" src="_images/T3E1-single-photon-interferometer-complete.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 28 </span><span class="caption-text">Considering all inputs and outputs for the complete description of the Mach-Zender interferometer.</span><a class="headerlink" href="#fig-t3e1-single-photon-interferometer-complete" title="Permalink to this image">¶</a></p>
</div>
<p>Now we can proceed to find the annihilation operators as before, but with all inputs included.</p>
<div class="math notranslate nohighlight">
\[\chat = \frac{\ahat + \bhat}{\sqrt{2}}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\dhat = \frac{\ahat - \bhat}{\sqrt{2}}\mathrm{.}\]</div>
<p>We then account for propagation over paths <span class="math notranslate nohighlight">\(l_1\)</span> and <span class="math notranslate nohighlight">\(l_2\)</span> which lead to a phase shift of <span class="math notranslate nohighlight">\(\phi_n = 2 \pi l_n/\lambda\)</span>.</p>
<div class="math notranslate nohighlight">
\[\ehat = \dhat e^{i\phi_2}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\fhat = \chat e^{i\phi_1}\mathrm{.}\]</div>
<p>From here, we account for the fact that at the second beamsplitter we have</p>
<div class="math notranslate nohighlight">
\[\ghat = \frac{\ehat + \fhat}{\sqrt{2}}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\hhat = \frac{\ehat - \fhat}{\sqrt{2}}\mathrm{.}\]</div>
<p>After substituting everything in we get the final expression for <span class="math notranslate nohighlight">\(\ghat\)</span>:</p>
<div class="math notranslate nohighlight">
\[\ghat = e^{i\phi_2} e^{i\Delta\phi/2} \bigg \lbrace \ahat \cos(\Delta\phi/2)  + i \bhat \sin(\Delta\phi/2) \bigg \rbrace \]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta \phi = \phi_1 - \phi_2\)</span>, the phase difference between the two arms.</p>
<p>Note that the number operator for <span class="math notranslate nohighlight">\(g\)</span> is then:</p>
<div class="math notranslate nohighlight">
\[\gdagger \ghat = \cos^2(\Delta \phi /2)\adagger\ahat + j\adagger\bhat \cos(\Delta\phi/2)\sin(\Delta\phi/2) - j\bdagger\ahat \cos(\Delta\phi/2)\sin(\Delta\phi/2) + \bdagger\bhat \sin^2(\Delta\phi/2)  \mathrm{.}\]</div>
<p>Given our input state is <span class="math notranslate nohighlight">\(\ket{1}_a \ket{0}_b\)</span>, the photon number is then found by taking:</p>
<div class="math notranslate nohighlight">
\[N_g = \bra{0}_b \bra{1}_a \gdagger \ghat \ket{1}_a \ket{0}_b  = \frac{1}{2} \lbrace 1 + \cos(\Delta\phi ) \rbrace \mathrm{.}\]</div>
<p>Note that only the terms with <span class="math notranslate nohighlight">\(\adagger \ahat\)</span> have a non-zero contribution – this justifies our neglecting the vacuum-state inputs for calculation of the output photon number.</p>
<p>However, it we emphasize that you must use this more complete treatment and account for the vacuum-state inputs to accurately predict the quantum noise in systems. For example, the standard deviation of the photon number depends on <span class="math notranslate nohighlight">\(\hat{N}^2\)</span> (see the note in <a class="reference internal" href="BASICS-quantum-optics-basics.html#basics-mean-and-standard-deviation"><span class="std std-ref">Mean and Standard Deviation Observables</span></a>), and the vacuum state inputs can contribute to the expectation <span class="math notranslate nohighlight">\(\left &lt; \hat{N}^2 \right &gt;\)</span>.   As a further example, to see the importance of the vacuum state input in interferometry, please see the use of squeezed vacuum to reduce quantum noise as described in <a class="reference internal" href="T3E1-EXTRAS-interference-2-homodyne-detection.html"><span class="doc std std-doc">EXTRAS – Homodyne Detection</span></a>.</p>
</div>
<div class="section" id="accounting-for-the-partial-absorber">
<h2>Accounting for the partial absorber<a class="headerlink" href="#accounting-for-the-partial-absorber" title="Permalink to this headline">¶</a></h2>
<p>For the partial absorber, again our treatment in the text was adequate for accounting for the outgoing photon number.  However, a rigorous solution requires accounting for the vacuum state here again.</p>
<p>The partial absorber can in fact be modeled as a beamsplitter with adjustable transmission/reflection with one input being the vacuum state, the other being the input state, and one output going to a perfect absorber, and the other transmitting out.  See <a class="reference internal" href="#fig-t3e1-partial-absorber-model"><span class="std std-numref">Fig. 29</span></a>.</p>
<div class="figure align-default" id="fig-t3e1-partial-absorber-model">
<a class="bg-primary mb-1 reference internal image-reference" href="_images/T3E1-partial-absorber-model.png"><img alt="Partial Absorber Model" class="bg-primary mb-1" src="_images/T3E1-partial-absorber-model.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 29 </span><span class="caption-text">Model of a partial absorber using a beamsplitter to account for the vacuum state.</span><a class="headerlink" href="#fig-t3e1-partial-absorber-model" title="Permalink to this image">¶</a></p>
</div>
<p>This model accounts for the vacuum state properly.  Note here the beamsplitter is not a 50:50 beamsplitter to account for the adjustable transmission probability.  The input/output relations are similar, with:</p>
<div class="math notranslate nohighlight">
\[\chat = t\ahat + r\bhat\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\dhat = r\ahat - t\bhat \mathrm{.}\]</div>
<p>From the derivation in the text, we have that <span class="math notranslate nohighlight">\(t = \alpha\)</span>, and <span class="math notranslate nohighlight">\(r = \sqrt{1 - \alpha^2}\)</span>.  You can show that with this element in the Mach-Zender interferometer, the output photon number expectation is equivalent to what we derived, with the number of detected photons being</p>
<div class="math notranslate nohighlight">
\[N_d = \frac{1}{4}\lbrace 1 + t^2 + 2t\cos(\Delta \phi)\rbrace \mathrm{.}\]</div>
<p>However, as noted earlier, the impact of this absorbing object is to effectively couple in vacuum state which must be accounted for during analysis of the quantum noise limit of the interferometer.</p>
</div>
<div class="section" id="accounting-for-bandwidth">
<h2>Accounting for Bandwidth<a class="headerlink" href="#accounting-for-bandwidth" title="Permalink to this headline">¶</a></h2>
<p>Finally, let us address the issue of the state having a non-zero bandwidth.  Up until now, we have discussed states from the context of a single frequency.  Our results would imply that interference would continue indefinitely as one changes delay.  However, in practice our source states will have a non-zero bandwidth which leads to a finite range of delays over which one would observe interference.  In this section, we will introduce how to account for this bandwidth.</p>
<p>For the case of a non-zero bandwidth, we can write our single-photon input state as</p>
<div class="math notranslate nohighlight">
\[ \ket{\psi_\mathrm{in}} = \int_{-\infty}^\infty \mathrm{d}\omega \phi(\omega) \ket{1;\omega}_a \mathrm{,}\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi(\omega)\)</span> contains the spectral amplitude and phase distirubtion for each frequency component. Note that by normalization we have that</p>
<div class="math notranslate nohighlight">
\[\braket{\psi_\mathrm{in}}{\psi_\mathrm{in}}  = \int_{-\infty}^\infty \mathrm{d}\omega_1 \int_{-\infty}^\infty \mathrm{d}\omega_2 \phi(\omega_2)^{*} \phi(\omega_1) \braket{1;\omega_2}{1;\omega_1}_a \]</div>
<p>Given orthonormality we have that <span class="math notranslate nohighlight">\(\braket{1;\omega_2}{1;\omega_1}_a = \delta(\omega_2 - \omega_1)\)</span>, which removes the second integral, simplifying everything to</p>
<div class="math notranslate nohighlight">
\[\braket{\psi_\mathrm{in}}{\psi_\mathrm{in}}  = \int_{-\infty}^\infty \mathrm{d}\omega_1  |\phi(\omega_1)|^2 = 1\]</div>
<p>What is this all saying?  Basically, we are saying that we have a probability of 1 of finding a photon over a range of frequncies defined by the distribution <span class="math notranslate nohighlight">\(|\phi(\omega)|^2\)</span>.  While we will always find a photon, we just don’t know for certain what energy it has due to the finite bandwidth of our source.</p>
<p>Taking this further, we can define the state in terms of the creation operator.</p>
<div class="math notranslate nohighlight">
\[ \ket{\psi_\mathrm{in}} = \int_{-\infty}^\infty \mathrm{d}\omega \phi(\omega) \adagger(\omega) \ket{0}_a \mathrm{.}\]</div>
<p>In this way, we can track the operators through any system in the same way as we already have for the single-frequency states.  Following this method, we can re-express our output state calculated from our earlier analysis of the interferometer now accounting for the non-zero bandwidth:</p>
<div class="math notranslate nohighlight">
\[\ket{\psi_\mathrm{out}} = \int_{-\infty}^\infty \mathrm{d}\omega \cos \bigg ( \frac{\omega \Delta l}{2c} \bigg )\phi(\omega) \ket{1;\omega}_a \mathrm{.}\]</div>
<p>Note that here it is important as we write the phase difference in terms of <span class="math notranslate nohighlight">\(\omega\)</span> and the path length difference <span class="math notranslate nohighlight">\(\Delta l\)</span>.  What is the probability of finding a photon then.  Well, we just take <span class="math notranslate nohighlight">\(\braket{\psi_\mathrm{out}}{\psi_\mathrm{out}}\)</span>, which becomes</p>
<div class="math notranslate nohighlight">
\[\braket{\psi_\mathrm{in}}{\psi_\mathrm{in}}  = \int_{-\infty}^\infty \mathrm{d}\omega_1 \int_{-\infty}^\infty \mathrm{d}\omega_2 \phi(\omega_2)^{*} \phi(\omega_1) \cos \bigg ( \frac{\omega_1 \Delta l}{2c} \bigg )\cos \bigg ( \frac{\omega_2 \Delta l}{2c} \bigg )\braket{1;\omega_2}{1;\omega_1}_a \]</div>
<p>Again, we have that <span class="math notranslate nohighlight">\(\braket{1;\omega_2}{1;\omega_1}_a = \delta(\omega_2 - \omega_1)\)</span>, and after substitution this again gets us back to one integral:</p>
<div class="math notranslate nohighlight">
\[\braket{\psi_\mathrm{in}}{\psi_\mathrm{in}}  = \int_{-\infty}^\infty \mathrm{d}\omega_1 |\phi(\omega_1)|^2 \cos \bigg ( \frac{\omega_1 \Delta l}{2c} \bigg )^2 \mathrm{.}\]</div>
<p>Note that the major difference here is the adddition of the cosine term.  This resuts in an oscillation of the output photon detction probability.  Note that the bandwidth probability distirubution function <span class="math notranslate nohighlight">\(\phi\)</span> then dictates the range of delays over which you see this oscillation in probability.  Importantly, note that that all phase information inside of <span class="math notranslate nohighlight">\(\phi\)</span> is lost as the output is dictated by <span class="math notranslate nohighlight">\(|\phi|^2\)</span> (our interferometer is, after all, only sensitive the phase differences between the two arms, and not to the absolute phase of the incoming state).</p>
<p>Let’s now numerically explore the single-photon interference accounting for bandwidth.</p>
<p>We start by taking a Gaussian distribution for <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># -- Settings -- </span>
<span class="n">c</span>  <span class="o">=</span> <span class="mi">300</span> <span class="c1">#speed of light in nm/fs</span>
<span class="n">lambda_0</span> <span class="o">=</span> <span class="mi">810</span> <span class="c1"># central wavelength in nm</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># bandwidth of the photons in petahertz</span>
<span class="n">omega_0</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="n">lambda_0</span> <span class="c1">#central frequency of the photons</span>

<span class="c1"># -- Calculations</span>

<span class="c1">#Set up the frequency axis (rad/fs)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">omega_0</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">omega_0</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="c1">#Define the initial gaussian frequency distribution</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">omega</span> <span class="o">-</span> <span class="n">omega_0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#Ensure it is normalized properly</span>
<span class="n">norm_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">omega</span><span class="p">))</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span><span class="o">/</span><span class="n">norm_factor</span>

<span class="c1">#Plot for visualization</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\phi(\omega)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\omega$ (rad/fs)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi(\omega)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/T3E1-EXTRAS--rigorous-solution-MZI_10_0.png" src="_images/T3E1-EXTRAS--rigorous-solution-MZI_10_0.png" />
</div>
</div>
<div class="figure align-default" id="t3e1-fig-photon-bandwidth" style="width: 800px">
<div class="cell_output docutils container">
<img alt="_images/T3E1-EXTRAS--rigorous-solution-MZI_11_0.png" src="_images/T3E1-EXTRAS--rigorous-solution-MZI_11_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 30 </span><span class="caption-text">Normalized spectral distribution of single-photons.</span><a class="headerlink" href="#t3e1-fig-photon-bandwidth" title="Permalink to this image">¶</a></p>
</div>
<p>Next, we define the path length difference and perform the integral for each choice of delay.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#-- Settings -- </span>

<span class="c1">#Define the delay length (in nm)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10e3</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="c1">#Path length difference to scan over</span>

<span class="c1"># -- Calculations -- </span>

<span class="c1">#Set up vector for output probabilities</span>
<span class="n">P_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#Probability of seeing a photon at the output</span>

<span class="c1">#Now calculate output probability for each delay</span>
<span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>

    <span class="n">P_out</span><span class="p">[</span><span class="n">cc</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">l</span><span class="p">[</span><span class="n">cc</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">c</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">omega</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">P_out</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;delay length (nm)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;photon detection probability&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/T3E1-EXTRAS--rigorous-solution-MZI_14_0.png" src="_images/T3E1-EXTRAS--rigorous-solution-MZI_14_0.png" />
</div>
</div>
<div class="figure align-default" id="t3e1-fig-photon-bandwidth-interference" style="width: 800px">
<div class="cell_output docutils container">
<img alt="_images/T3E1-EXTRAS--rigorous-solution-MZI_15_0.png" src="_images/T3E1-EXTRAS--rigorous-solution-MZI_15_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 31 </span><span class="caption-text">Normalized spectral distribution of single-photons.</span><a class="headerlink" href="#t3e1-fig-photon-bandwidth-interference" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="T3E1-LAB--entanglement-interference-quantum-enhanced-sensing.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">LAB – Interference, Entanglement and Quantum-Enhanced Metrology</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="T3E1-EXTRAS-interference-2-homodyne-detection.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">EXTRAS – Homodyne Detection</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Dirk Englund, Donnie Keathley, Jane Heyes, Kevin Chen<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>